!function(e,i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof exports?module.exports=i(require("jquery")):e.Dropify=i(e.jQuery)}(this,function(e){function i(i,t){if(window.File&&window.FileReader&&window.FileList&&window.Blob){this.element=i,this.input=e(this.element),this.wrapper=null,this.preview=null,this.filenameWrapper=null,this.settings=e.extend(!0,{defaultFile:"",maxFileSize:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,showRemove:!0,showLoader:!0,showErrors:!0,errorTimeout:1e4,errorsPosition:"overlay",imgFileExtensions:["png","jpg","jpeg","gif","bmp"],maxFileSizePreview:"5M",allowedFormats:["portrait","square","landscape"],allowedFileExtensions:["*"],messages:{default:"Drag and drop a file here or click",replace:"Drag and drop or click to replace",remove:"Remove",error:"Ooops, something wrong happended."},error:{fileSize:"The file size is too big ({{ value }} max).",minWidth:"The image width is too small ({{ value }}}px min).",maxWidth:"The image width is too big ({{ value }}}px max).",minHeight:"The image height is too small ({{ value }}}px min).",maxHeight:"The image height is too big ({{ value }}px max).",imageFormat:"The image format is not allowed ({{ value }} only).",fileExtension:"The file is not allowed ({{ value }} only)."},tpl:{wrap:'<div class="dropify-wrapper"></div>',loader:'<div class="dropify-loader"></div>',message:'<div class="dropify-message"><span class="file-icon" /> <p>{{ default }}</p></div>',preview:'<div class="dropify-preview"><span class="dropify-render"></span><div class="dropify-infos"><div class="dropify-infos-inner"><p class="dropify-infos-message">{{ replace }}</p></div></div></div>',filename:'<p class="dropify-filename"><span class="dropify-filename-inner"></span></p>',clearButton:'<button type="button" class="dropify-clear">{{ remove }}</button>',errorLine:'<p class="dropify-error">{{ error }}</p>',errorsContainer:'<div class="dropify-errors-container"><ul></ul></div>'}},t,this.input.data()),this.errorsEvent=e.Event("dropify.errors"),this.isDisabled=!1,this.isInit=!1,this.file={object:null,name:null,size:null,width:null,height:null,type:null},this.fileDetails=[],this.fileNumbers=0,Array.isArray(this.settings.allowedFormats)||(this.settings.allowedFormats=this.settings.allowedFormats.split(" ")),Array.isArray(this.settings.allowedFileExtensions)||(this.settings.allowedFileExtensions=this.settings.allowedFileExtensions.split(" ")),this.onChange=this.onChange.bind(this),this.clearElement=this.clearElement.bind(this),this.onFileReady=this.onFileReady.bind(this),this.translateMessages(),this.createElements(),this.setContainerSize(),this.errorsEvent.errors=[],this.input.on("change",this.onChange)}}return i.prototype.onChange=function(){this.resetPreview(),this.readFile(this.element)},i.prototype.createElements=function(){this.isInit=!0,this.input.wrap(e(this.settings.tpl.wrap)),this.wrapper=this.input.parent();var i=e(this.settings.tpl.message).insertBefore(this.input);e(this.settings.tpl.errorLine).appendTo(i),!0===this.isTouchDevice()&&this.wrapper.addClass("touch-fallback"),this.input.attr("disabled")&&(this.isDisabled=!0,this.wrapper.addClass("disabled")),!0===this.settings.showLoader&&(this.loader=e(this.settings.tpl.loader),this.loader.insertBefore(this.input)),this.preview=e(this.settings.tpl.preview),this.preview.insertAfter(this.input),!1===this.isDisabled&&!0===this.settings.showRemove&&(this.clearButton=e(this.settings.tpl.clearButton),this.clearButton.insertAfter(this.input),this.clearButton.on("click",this.clearElement)),this.filenameWrapper=e(this.settings.tpl.filename),this.filenameWrapper.prependTo(this.preview.find(".dropify-infos-inner")),!0===this.settings.showErrors&&(this.errorsContainer=e(this.settings.tpl.errorsContainer),"outside"===this.settings.errorsPosition?this.errorsContainer.insertAfter(this.wrapper):this.errorsContainer.insertBefore(this.input));var t=this.settings.defaultFile||"";if(""!==t.trim()){this.setPreview(this.isImage(this.cleanFilename(t),1),t,[],this.cleanFilename(t))}},i.prototype.readFile=function(i){if(i.files&&i.files[0])for(var t=0;t<i.files.length;t++){this.fileDetails.push(i.files[t]);var s=new FileReader,r=new Image,n=i.files[t],o=null,h=this,a=e.Event("dropify.fileReady");this.clearErrors(),this.showLoader(),this.errorsEvent.errors=[],this.checkFileSize(n),this.isFileExtensionAllowed(n),this.isImage(n)&&n.size<this.sizeToByte(this.settings.maxFileSizePreview)?(this.input.on("dropify.fileReady",this.onFileReady()),s.readAsDataURL(n),s.onload=function(e){o=e.target.result,r.src=e.target.result,r.onload=function(){h.validateImage(this.width,this.height),h.input.trigger(a,[!0,o])}}.bind(this)):this.onFileReady(!1)}},i.prototype.onFileReady=function(e,i,t){if(this.input.off("dropify.fileReady",this.onFileReady),0===this.errorsEvent.errors.length)this.setPreview(i,t,this.fileDetails[this.fileNumbers]);else{this.input.trigger(this.errorsEvent,[this]);for(var s=this.errorsEvent.errors.length-1;s>=0;s--){var r=this.errorsEvent.errors[s].namespace.split(".").pop();this.showError(r)}if(void 0!==this.errorsContainer){this.errorsContainer.addClass("visible");var n=this.errorsContainer;setTimeout(function(){n.removeClass("visible")},this.settings.errorTimeout)}this.wrapper.addClass("has-error"),this.resetPreview(),this.clearElement()}this.fileNumbers++},i.prototype.setFileInformations=function(e){this.file.object=e,this.file.name=e.name,this.file.size=e.size,this.file.type=e.type,this.file.width=null,this.file.height=null},i.prototype.setFileDimensions=function(e,i){this.file.width=e,this.file.height=i},i.prototype.setPreview=function(i,t,s,r=""){if(this.wrapper.removeClass("has-error").addClass("has-preview"),1==this.fileDetails.length)this.filenameWrapper.children(".dropify-filename-inner").html(s.name);else if(this.fileDetails.length>1){var n=this.numberInWords(this.fileDetails.length);this.filenameWrapper.children(".dropify-filename-inner").html(n)}else this.filenameWrapper.children(".dropify-filename-inner").html(r);var o=this.preview.children(".dropify-render");if(this.hideLoader(),!0===i){var h=e("<img />").attr("src",t);this.settings.height&&h.css("max-height",this.settings.height),h.appendTo(o)}else e("<i />").attr("class","dropify-font-file").appendTo(o),1==this.fileDetails.length?e('<span class="dropify-extension" />').html(this.getFileType(s)).appendTo(o):this.fileDetails.length>1?e('<span class="dropify-extension" />').html(this.getFileType(s)).appendTo(o):e('<span class="dropify-extension" />').html(this.getFileType(r,1)).appendTo(o);this.preview.fadeIn()},i.prototype.resetPreview=function(){this.wrapper.removeClass("has-preview");var e=this.preview.children(".dropify-render");e.find(".dropify-extension").remove(),e.find("i").remove(),e.find("img").remove(),this.preview.hide(),this.hideLoader(),this.fileNumbers=0,this.fileDetails=[]},i.prototype.cleanFilename=function(e){var i=e.split("\\").pop();return i==e&&(i=e.split("/").pop()),""!==e?i:""},i.prototype.clearElement=function(){if(0===this.errorsEvent.errors.length){var i=e.Event("dropify.beforeClear");this.input.trigger(i,[this]),!1!==i.result&&(this.resetFile(),this.input.val(""),this.resetPreview(),this.input.trigger(e.Event("dropify.afterClear"),[this]))}else this.resetFile(),this.input.val(""),this.resetPreview()},i.prototype.resetFile=function(){this.fileNumbers=0,this.fileDetails=[]},i.prototype.setContainerSize=function(){this.settings.height&&this.wrapper.height(this.settings.height)},i.prototype.isTouchDevice=function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},i.prototype.getFileType=function(e,i=0){if(void 0!==e)return 1==i?e.split(".").pop().toLowerCase():e.name.split(".").pop().toLowerCase()},i.prototype.isImage=function(e,i=0){var t=1==i?this.getFileType(e,1):this.getFileType(e);return"-1"!=this.settings.imgFileExtensions.indexOf(t)},i.prototype.isFileExtensionAllowed=function(e){return"-1"!=this.settings.allowedFileExtensions.indexOf("*")||"-1"!=this.settings.allowedFileExtensions.indexOf(this.getFileType(e))||(this.pushError("fileExtension"),!1)},i.prototype.translateMessages=function(){for(var e in this.settings.tpl)for(var i in this.settings.messages)this.settings.tpl[e]=this.settings.tpl[e].replace("{{ "+i+" }}",this.settings.messages[i])},i.prototype.checkFileSize=function(e){0!==this.sizeToByte(this.settings.maxFileSize)&&e.size>this.sizeToByte(this.settings.maxFileSize)&&this.pushError("fileSize")},i.prototype.sizeToByte=function(e){var i=0;if(0!==e){var t=e.slice(-1).toUpperCase();"K"===t?i=1024*parseFloat(e):"M"===t?i=1048576*parseFloat(e):"G"===t&&(i=1073741824*parseFloat(e))}return i},i.prototype.validateImage=function(e,i){0!==this.settings.minWidth&&this.settings.minWidth>=e&&this.pushError("minWidth"),0!==this.settings.maxWidth&&this.settings.maxWidth<=e&&this.pushError("maxWidth"),0!==this.settings.minHeight&&this.settings.minHeight>=i&&this.pushError("minHeight"),0!==this.settings.maxHeight&&this.settings.maxHeight<=i&&this.pushError("maxHeight"),"-1"==this.settings.allowedFormats.indexOf(this.getImageFormat(e,i))&&this.pushError("imageFormat")},i.prototype.getImageFormat=function(e,i){return e==i?"square":e<i?"portrait":e>i?"landscape":void 0},i.prototype.pushError=function(i){var t=e.Event("dropify.error."+i);this.errorsEvent.errors.push(t),this.input.trigger(t,[this])},i.prototype.clearErrors=function(){void 0!==this.errorsContainer&&this.errorsContainer.children("ul").html("")},i.prototype.showError=function(e){void 0!==this.errorsContainer&&this.errorsContainer.children("ul").append("<li>"+this.getError(e)+"</li>")},i.prototype.getError=function(e){var i=this.settings.error[e],t="";return"fileSize"===e?t=this.settings.maxFileSize:"minWidth"===e?t=this.settings.minWidth:"maxWidth"===e?t=this.settings.maxWidth:"minHeight"===e?t=this.settings.minHeight:"maxHeight"===e?t=this.settings.maxHeight:"imageFormat"===e?t=this.settings.allowedFormats.join(", "):"fileExtension"===e&&(t=this.settings.allowedFileExtensions.join(", ")),""!==t?i.replace("{{ value }}",t):i},i.prototype.showLoader=function(){void 0!==this.loader&&this.loader.show()},i.prototype.hideLoader=function(){void 0!==this.loader&&this.loader.hide()},i.prototype.destroy=function(){this.input.siblings().remove(),this.input.unwrap(),this.isInit=!1},i.prototype.init=function(){this.createElements()},i.prototype.isDropified=function(){return this.isInit},e.fn.dropify=function(t){return this.each(function(){e.data(this,"dropify")||e.data(this,"dropify",new i(this,t))}),this},i.prototype.numberInWords=function(e){var i=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],t=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if((e=e.toString()).length>9)return"overflow";if(n=("000000000"+e).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/),n){var s="";return s+=0!=n[1]?(i[Number(n[1])]||t[n[1][0]]+" "+i[n[1][1]])+"crore ":"",s+=0!=n[2]?(i[Number(n[2])]||t[n[2][0]]+" "+i[n[2][1]])+"lakh ":"",s+=0!=n[3]?(i[Number(n[3])]||t[n[3][0]]+" "+i[n[3][1]])+"thousand ":"",s+=0!=n[4]?(i[Number(n[4])]||t[n[4][0]]+" "+i[n[4][1]])+"hundred ":"",s+=0!=n[5]?(""!=s?"and ":"")+(i[Number(n[5])]||t[n[5][0]]+" "+i[n[5][1]])+"Files Uploaded":""}},i});